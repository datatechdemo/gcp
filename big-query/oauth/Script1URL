# A PowerShell script for getting an OAuth code URL from Google

# Please obtained ClientID and Client Secret from the GCP console.
$clientId = "548550014762-oig1e6mvbqko15bkbrb39e9on1eqadsh.apps.googleusercontent.com"
$clientSecret = "-UIyUTFlqsKEZ3-3Hl3Oi9mM"
$redirectUrl = "http://127.0.0.1/"


# This is the access scope we will be requesting
$scope = "https://www.googleapis.com/auth/bigquery"


# Build the URL for Google's OAuth service
$authUrl = "https://accounts.google.com/o/oauth2/v2/auth"
$authUrl += "?client_id=" + $clientId
$authUrl += "&redirect_uri=" + [uri]::EscapeDataString($redirectUrl)
$authUrl += "&scope=" + [uri]::EscapeDataString($scope)
$authUrl += "&access_type=offline&include_granted_scopes=true&response_type=code&prompt=consent"

Write-Host "`n`n$("*" * 80) `n"
Write-Host "Open the follwing URL in your web browser:`n"
Write-Host "`t$authUrl`n"
Write-Host "Log into Google and grant consent to the application.  After clicking allow, you will be redirected to a URL."
Write-Host "Copy the URL to which you are redirected and proceed to second script"
Write-Host "`n$("*" * 80) `n`n"
